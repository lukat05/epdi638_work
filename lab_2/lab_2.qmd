---
title: "EPID 638/CMPLXSYS 530 Lab 2"
author: Luka Todorovic
date: "February 10, 2026"
format:
  html:
    toc: false
    number-sections: true
    colorlinks: true
jupyter: python3
---

# Problem 1

## A)



## B)



## C)



## D)





# Problem 2

## A) Here's my code!

```{python}
import matplotlib.pyplot as plt
import numpy as np
from pylab import *
def Initialize():
    global grid, ant, step
    grid = np.zeros([11, 11])
    ant = [5, 5, 0]
    step = 0


def Observe():
    plt.cla()
    plt.imshow(grid, cmap=plt.cm.binary, vmin=0, vmax=1)
    ant_mark = {0:'^', 1:'>', 2:'v', 3:'<'}
    plt.scatter(ant[1], ant[0], s=100, c='red', marker=ant_mark[ant[2]])
    plt.title(f"Step: {step}")
    plt.show()


def Update():
    global grid, ant, step
    r, c, dir = ant[0], ant[1], ant[2]

    if grid[r, c] == 0:
        dir = (dir+1)%4
        grid[r, c] = 1

    else:
        dir = (dir-1)%4
        grid[r, c] = 0

    ant[2] = dir
    if dir == 0:
        ant[0] -= 1

    elif dir == 1:
        ant[1] += 1

    elif dir == 2:
        ant[0] += 1

    elif dir == 3:
        ant[1] -= 1

    ant[0] %= 11
    ant[1] %= 11
    step += 1

Initialize()
for _ in range(200):
    Update()
Observe()
```

## B)



## C)

```{python}
import matplotlib.pyplot as plt
import numpy as np
from pylab import *
def Initialize():
    global grid, ant, step
    grid = np.zeros([50, 50])
    for i in range(3):
        for j in range(3):
            grid[24+i, 24+j] = np.random.binomial(n=1, p=.5)

    ant = [25, 25, 0]
    step = 0


def Observe():
    plt.cla()
    plt.imshow(grid, cmap=plt.cm.binary, vmin=0, vmax=1)
    ant_mark = {0:'^', 1:'>', 2:'v', 3:'<'}
    plt.scatter(ant[1], ant[0], s=100, c='red', marker=ant_mark[ant[2]])
    plt.title(f"Step: {step}")
    plt.show()


def Update():
    global grid, ant, step
    r, c, dir = ant[0], ant[1], ant[2]

    if grid[r, c] == 0:
        dir = (dir+1)%4
        grid[r, c] = 1

    else:
        dir = (dir-1)%4
        grid[r, c] = 0

    ant[2] = dir
    if dir == 0:
        ant[0] -= 1

    elif dir == 1:
        ant[1] += 1

    elif dir == 2:
        ant[0] += 1

    elif dir == 3:
        ant[1] -= 1

    ant[0] %= 50
    ant[1] %= 50
    step += 1

Initialize()
for _ in range(2000):
    Update()
Observe()
```

# Problem 3

```{python}
from math import *
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx

g = nx.read_gml('polbooks.gml')
pos=nx.spring_layout(g)
nx.draw_networkx(g, pos, with_labels = False, node_size = 100)
plt.show()
```
## A)

```{python}
deg_seq = [d for n, d in g.degree()]

plt.hist(deg_seq)
plt.title("Degree distribution (Linear)")
plt.xlabel("Degree")
plt.ylabel("Frequency")
plt.show()
```

```{python}
import collections

degree_counts = collections.Counter(deg_seq)
x, y =zip(*degree_counts.items())

plt.scatter(x, y)
plt.title("Degree distribution (Logarithmic)")
plt.xscale('log')
plt.yscale('log')
plt.xlabel("np.log(Degree)")
plt.ylabel("Frequency")
plt.show()
```

## B)

For this part, I decided to use Eigenvector centrality.

```{python}
centrality = nx.eigenvector_centrality_numpy(g)
node_colors = [centrality[node] for node in g.nodes()]
pos = nx.spring_layout(g)
nodes = nx.draw_networkx(
    g, pos,
    with_labels=False,
    node_size=100,
    node_color=node_colors,
    cmap=plt.cm.viridis
)


sorted_centrality = sorted(centrality.items(), key=lambda item: item[1], reverse=True)
for node, score in sorted_centrality[:5]:
    print(f"Book {node}: {score:.4f}")
```

## C)

```{python}
pos = nx.spring_layout(g)
node_colors = []
for n, v in g.nodes(data=True):
    if v['value'] == 'n': node_colors.append('gray')
    elif v['value'] == 'c': node_colors.append('red')
    elif v['value'] == 'l': node_colors.append('blue')

nodes = nx.draw_networkx(
    g, pos,
    with_labels=False,
    node_size=100,
    node_color=node_colors
)

nx.attribute_assortativity_coefficient(g, 'value')
```


# Problem 4

PLEASE NOTE: If this project sounds like Deepan Islam's, it's because we are working together on it. Shout out to him
fir finding the cool paper we're going to analyze together, and I hope that as an undergraduate, I can learn alot from
my PhD student counterpart!

## A)

I'm really interested in getting more involved in epidemiological modeling and disease/pathogen dynamics, since it is an
area that I myself have not had much exposure to. When talking with Deepan, he brought up his own expertise in the area,
and we agreed that we'd be a good fit as partners. He introduced me to the first paper on Phylodynamics that you see
in part B below, and from there we just felt that it would be a good fit for us both in terms of interests and
abilities!

## B)

Here are the two papers that we found!

1. Phylodynamics on local sexual contact networks David A. Rasmussen et al. (2017) develop a probabilistic framework
linking local sexual contact network structure to coalescent/phylogenetic patterns, and show how network properties can
be estimated (likelihood-based) from pathogen phylogenies, with an HIV-1 Switzerland application.
https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005448

2. Nonparametric inference of interaction laws in systems of agents from trajectory data Fei Lu et al. (2019) propose a
nonparametric method to infer pairwise-distance interaction kernels from observed multi-agent trajectories, with theory
and demonstrations across some classic systems like Cucker-Smale flocking.

## C)